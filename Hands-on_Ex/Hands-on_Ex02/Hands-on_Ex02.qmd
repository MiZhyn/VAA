---
title: "Hands-on Ex02"
Published: Apil 15，2024
---

# 1. Overview

In this chapter, I will practice several ggplot2 extensions to create more elegant and effective statistical graphics.

-   control the placement of annotation on a graph by using functions provided in ggrepel package,

-   create professional publication quality figure by using functions provided in ggthemes and hrbrthemes packages,

-   plot composite figure by combining ggplot2 graphs by using patchwork package.

# 2. Getting start

### **2.1 Installing and loading the required libraries**

Four R packages will be used. They are:

-   ggrepel: an R package provides geoms for ggplot2 to repel overlapping text labels.

-   ggthemes: an R package provides some extra themes, geoms, and scales for ‘ggplot2’.

-   hrbrthemes: an R package provides typography-centric themes and theme components for ggplot2.

-   patchwork: an R package for preparing composite figure created using ggplot2.

```{r}
pacman::p_load(ggrepel, patchwork, 
               ggthemes, hrbrthemes,
               tidyverse) 
```

## 2.2 **Importing data**

```{r}
exam_data <- read_csv("Data/Exam_data.csv",show_col_types = FALSE)
head(exam_data)
```

## 2.3 **Beyond ggplot2 Annotation: ggrepel**

One of the challenge in plotting statistical graph is annotation, especially with large number of data points.

#\| output: False

::: panel-tabset
# The Plot

```{r}
#| echo: False
ggplot(data=exam_data,
       aes(x=MATHS,
           y=ENGLISH))+
  geom_point()+
  geom_smooth(method=lm,
              size=0.5)+
  geom_label(aes(label=ID),
             hjust=0.3,
              vjust=-0.3)+
   coord_cartesian(xlim=c(0,100),
                    ylim=c(0,100))+ 
ggtitle("English scores versus Maths scores for Primary 3")

```

## The code

```{r}
#| output: False
ggplot(data=exam_data,
       aes(x=MATHS,
           y=ENGLISH))+
  geom_point()+
  geom_smooth(method=lm,
              size=0.5)+
  geom_label(aes(label=ID),
             hjust=0.5,
              vjust=-0.5)+
   coord_cartesian(xlim=c(0,100),
                    ylim=c(0,100))+ 
ggtitle("English scores versus Maths scores for Primary 3")
```
:::

### **2.3.1 Working with ggrepel**

::: panel-tabset
## The plot

```{r}
#| echo: False
ggplot(data=exam_data,
       aes(x=MATHS,
           y=ENGLISH))+
  geom_point()+
  geom_smooth(method=lm,
              size=0.5)+
  geom_label_repel(aes(label=ID),
                   fontface="bold")+
  coord_cartesian(xlim=c(0,100),
                  ylim=c(0,100))+
  ggtitle("English scores versus Maths scores for Primary 3")
```

## The code

```{r}
#| output: False
ggplot(data=exam_data, 
             aes(x = MATHS)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") +
  theme_gray() +
  ggtitle("Distribution of Maths scores") 
```
:::

### **2.4.1 Working with ggtheme package**

```{r}
#| echo: False
ggplot(data=exam_data, 
             aes(x = MATHS)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") +
  ggtitle("Distribution of Maths scores") +
  theme_economist()
```

### **2.4.2 Working with hrbthems package**

```{r}
ggplot(data=exam_data, 
             aes(x = MATHS)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") +
  ggtitle("Distribution of Maths scores") +
  theme_ipsum()
```

```{r}
ggplot(data=exam_data, 
             aes(x = MATHS)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") +
  ggtitle("Distribution of Maths scores") +
  theme_ipsum(axis_title_size = 18,
              base_size = 15,
              grid = "Y")
```

## **2.5 Beyond Single Graph**

```{r}
p1 <- ggplot(data=exam_data, 
             aes(x = MATHS)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") + 
  coord_cartesian(xlim=c(0,100)) +
  ggtitle("Distribution of Maths scores")
```

```{r}
p2 <- ggplot(data=exam_data, 
             aes(x = ENGLISH)) +
  geom_histogram(bins=20, 
                 boundary = 100,
                 color="grey25", 
                 fill="grey90") +
  coord_cartesian(xlim=c(0,100)) +
  ggtitle("Distribution of English scores")
```

```{r}
p3 <- ggplot(data=exam_data, 
             aes(x= MATHS, 
                 y=ENGLISH)) +
  geom_point() +
  geom_smooth(method=lm, 
              size=0.5) +  
  coord_cartesian(xlim=c(0,100),
                  ylim=c(0,100)) +
  ggtitle("English scores versus Maths scores for Primary 3")
```

```{r}
p1 + p2
```

```{r}
(p1 / p2) | p3
```

### **2.5.5 Creating figure with insert**

```{r}
p3 + inset_element(p2, 
                   left = 0.02, 
                   bottom = 0.7, 
                   right = 0.5, 
                   top = 1)
```

### **2.5.6 Creating a composite figure by using patchwork and ggtheme**

```{r}
patchwork <- (p1 / p2) | p3
patchwork & theme_economist()
```
